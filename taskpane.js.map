{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane/./src/taskpane/taskpane.ts","webpack://office-addin-taskpane/./src/taskpane/taskpane.html","webpack://office-addin-taskpane/./node_modules/html-loader/dist/runtime/getUrl.js","webpack://office-addin-taskpane/webpack/bootstrap","webpack://office-addin-taskpane/webpack/runtime/compat get default export","webpack://office-addin-taskpane/webpack/runtime/define property getters","webpack://office-addin-taskpane/webpack/runtime/global","webpack://office-addin-taskpane/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane/webpack/runtime/publicPath","webpack://office-addin-taskpane/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane/webpack/startup"],"sourcesContent":["/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n\n/* global console, document, Excel, Office */\n\nOffice.onReady((info) => {\n  if (info.host === Office.HostType.Excel) {\n    document.getElementById(\"sideload-msg\").style.display = \"none\";\n    document.getElementById(\"app-body\").style.display = \"flex\";\n    document.getElementById(\"run\").onclick = run;\n\n    const dropZone = document.getElementById(\"dropZone\") as HTMLDivElement;\n    dropZone.addEventListener(\"dragover\", (event) => {\n      event.preventDefault();\n    });\n\n    dropZone.ondrop = fileDrop;\n  }\n});\n\nexport async function fileDrop(event: DragEvent) {\n  event.preventDefault();\n  event.stopPropagation();\n\n  const files = event.dataTransfer.files;\n  if (files.length > 0) {\n    const file = files[0];\n\n    const reader = new FileReader();\n\n    reader.onload = (e2: ProgressEvent<FileReader>) => {\n      const result = e2.target?.result;\n      Excel.run(async (context) => {\n        const range = context.workbook.getSelectedRange();\n        range.load(\"height\");\n        range.load(\"width\");\n        range.load(\"left\");\n        range.load(\"top\");\n        await context.sync();\n\n        const imageSize = await getImageSize(result.toString());\n\n        let startIndex = result.toString().indexOf(\"base64,\");\n        let myBase64 = result.toString().substr(startIndex + 7);\n        let sheet = context.workbook.worksheets.getActiveWorksheet();\n        let image = sheet.shapes.addImage(myBase64);\n        image.name = \"Image\";\n\n        let ratio = range.width / imageSize.width;\n        let height = imageSize.height * ratio;\n        let width = range.width;\n\n        if (height > range.height) {\n          ratio = range.height / imageSize.height;\n          height = range.height;\n          width = imageSize.width * ratio;\n        }\n\n        image.height = height;\n        image.width = width;\n\n        image.left = range.left + (range.width - width) / 2;\n        image.top = range.top + (range.height - height) / 2;\n\n        return context.sync();\n      }).catch(errorHandlerFunction);\n    };\n\n    // Read in the image file as a data URL.\n    reader.readAsDataURL(file);\n  }\n}\n\nexport async function run() {\n  try {\n    await Excel.run(async (context) => {\n      /**\n       * Insert your Excel code here\n       */\n      const range = context.workbook.getSelectedRange();\n\n      // Read the range address\n      range.load(\"address\");\n\n      // Update the fill color\n      range.format.fill.color = \"yellow\";\n\n      await context.sync();\n      console.log(`The range address was ${range.address}.`);\n    });\n  } catch (error) {\n    console.error(error);\n  }\n}\nfunction errorHandlerFunction(reason: any): PromiseLike<never> {\n  throw new Error(\"Function not implemented.\" + reason.toString());\n}\n\nasync function getImageSize(dataUrl: string): Promise<{ width: number; height: number }> {\n  return new Promise((resolve, reject) => {\n    const img = document.getElementById(\"preview\") as HTMLImageElement;\n\n    img.onload = () => {\n      const size = {\n        width: img.naturalWidth,\n        height: img.naturalHeight,\n      };\n\n      resolve(size);\n    };\n\n    img.onerror = (error) => {\n      reject(error);\n    };\n\n    img.src = dataUrl;\n  });\n}\n","// Imports\nimport ___HTML_LOADER_GET_SOURCE_FROM_IMPORT___ from \"../../node_modules/html-loader/dist/runtime/getUrl.js\";\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\n// Module\nvar ___HTML_LOADER_REPLACEMENT_0___ = ___HTML_LOADER_GET_SOURCE_FROM_IMPORT___(___HTML_LOADER_IMPORT_0___);\nvar code = \" <!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>Contoso Task Pane Add-in</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css\\\"/> <link href=\\\"\" + ___HTML_LOADER_REPLACEMENT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body class=\\\"ms-font-m ms-welcome ms-Fabric\\\"> <header class=\\\"ms-welcome__header ms-bgColor-neutralLighter\\\"> <h1 class=\\\"ms-font-su\\\">ImageFit</h1> </header> <section id=\\\"sideload-msg\\\" class=\\\"ms-welcome__main\\\"> <h2 class=\\\"ms-font-xl\\\">Please <a target=\\\"_blank\\\" href=\\\"https://learn.microsoft.com/office/dev/add-ins/testing/test-debug-office-add-ins#sideload-an-office-add-in-for-testing\\\">sideload</a> your add-in to see app body.</h2> </section> <main id=\\\"app-body\\\" class=\\\"ms-welcome__main\\\" style=\\\"display:none\\\"> <h2 class=\\\"ms-font-xl\\\"> 貼り付けたいセルを選択してから </h2> <div id=\\\"dropZone\\\" class=\\\"draggableZone\\\"> ここにファイルをドラッグ </div> <div role=\\\"button\\\" id=\\\"run\\\" class=\\\"ms-welcome__action ms-Button ms-Button--hero ms-font-xl\\\"> <span class=\\\"ms-Button-label\\\">Run</span> </div> <img id=\\\"preview\\\" style=\\\"display:none\\\"/> </main> </body> </html> \";\n// Exports\nexport default code;","\"use strict\";\n\nmodule.exports = function (url, options) {\n  if (!options) {\n    // eslint-disable-next-line no-param-reassign\n    options = {};\n  }\n\n  if (!url) {\n    return url;\n  } // eslint-disable-next-line no-underscore-dangle, no-param-reassign\n\n\n  url = String(url.__esModule ? url.default : url);\n\n  if (options.hash) {\n    // eslint-disable-next-line no-param-reassign\n    url += options.hash;\n  }\n\n  if (options.maybeNeedQuotes && /[\\t\\n\\f\\r \"'=<>`]/.test(url)) {\n    return \"\\\"\".concat(url, \"\\\"\");\n  }\n\n  return url;\n};","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript)\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) scriptUrl = scripts[scripts.length - 1].src\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t41: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\n__webpack_require__(14183);\nvar __webpack_exports__ = __webpack_require__(93823);\n"],"names":["fileDrop","event","preventDefault","stopPropagation","files","dataTransfer","length","file","reader","FileReader","onload","e2","result","_a","target","Excel","run","context","__awaiter","_this","range","workbook","getSelectedRange","load","sync","sent","getImageSize","toString","imageSize","startIndex","indexOf","myBase64","substr","sheet","worksheets","getActiveWorksheet","image","shapes","addImage","name","ratio","width","height","left","top","catch","errorHandlerFunction","readAsDataURL","format","fill","color","console","log","concat","address","error","error_1","reason","Error","dataUrl","Promise","resolve","reject","img","document","getElementById","size","naturalWidth","naturalHeight","onerror","src","Office","onReady","info","host","HostType","style","display","onclick","dropZone","addEventListener","ondrop","exports","___HTML_LOADER_IMPORT_0___","URL","module","url","options","String","__esModule","default","hash","maybeNeedQuotes","test","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","call","m","n","getter","d","a","definition","key","o","Object","defineProperty","enumerable","get","g","globalThis","this","Function","e","window","obj","prop","prototype","hasOwnProperty","scriptUrl","importScripts","location","currentScript","scripts","getElementsByTagName","replace","p","b","baseURI","self","href"],"sourceRoot":""}